# üì∞ News Bot ‚Äî —É–º–Ω—ã–π Telegram-–±–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ IT-–Ω–æ–≤–æ—Å—Ç–µ–π

![Tests](https://github.com/Golden-boy-jk/News_bot/actions/workflows/ci.yml/badge.svg)
![Coverage](https://img.shields.io/badge/coverage-100%25-brightgreen)
![Python](https://img.shields.io/badge/python-3.11-blue)
![License](https://img.shields.io/badge/license-MIT-green)

üì∞ News Bot ‚Äî Telegram IT News Aggregator

Production‚Äëready Telegram‚Äë–±–æ—Ç –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π –∏–∑ IT‚Äë–º–∏—Ä–∞. –ü—Ä–æ–µ–∫—Ç —Å–¥–µ–ª–∞–Ω –∫–∞–∫ pet‚Äëproject —É—Ä–æ–≤–Ω—è Middle, —Å —É–ø–æ—Ä–æ–º –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å.

- –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ **09:00 (Europe/Moscow)** —Å–æ–±–∏—Ä–∞–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å —Ç–æ–ø-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤;
- –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç, –æ—á–∏—â–∞–µ—Ç –µ–≥–æ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç;
- –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å —Å—Ç–∞—Ç—å–∏ —á–µ—Ä–µ–∑ **TF-IDF + keyword scoring**;
- —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ SQLite;
- –ø—É–±–ª–∏–∫—É–µ—Ç –ª—É—á—à–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –¥–Ω—è –≤ Telegram;
- –ø–æ —Å—É–±–±–æ—Ç–∞–º —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø–æ–¥–±–æ—Ä–∫—É —Ç—É–ª–∑–æ–≤ üîß;
- –ø–æ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è–º —Å–æ–∑–¥–∞—ë—Ç –Ω–µ–¥–µ–ª—å–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç üì∞;
- –≤—ã–ø–æ–ª–Ω—è–µ—Ç **–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–≤–µ–∂–µ—Å—Ç–∏ –Ω–æ–≤–æ—Å—Ç–µ–π** –∏ —à–ª—ë—Ç –∞–ª–µ—Ä—Ç—ã, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫.

–ü—Ä–æ–µ–∫—Ç –ø–æ–∫—Ä—ã—Ç **100% —Ç–µ—Å—Ç–æ–≤**, –∏–º–µ–µ—Ç –ø—Ä–æ–¥–∞–∫—à–µ–Ω-Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ, healthcheck, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª—ã –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ VPS.

---

# üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üì° –°–±–æ—Ä –∏ –ø–∞—Ä—Å–∏–Ω–≥ –Ω–æ–≤–æ—Å—Ç–µ–π
- –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Å–±–æ—Ä –ø—É–±–ª–∏–∫–∞—Ü–∏–π –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (APScheduler);
- –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ IT-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (AI, Python, Data Engineering, Security);
- –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ HTML-–∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –æ—á–∏—Å—Ç–∫–∞ (BeautifulSoup);
- —É–¥–∞–ª–µ–Ω–∏–µ `script`, `style`, `noscript`, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞.

### üß† –ê–Ω–∞–ª–∏–∑ –∏ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ
- —Ä–∞—Å—á—ë—Ç –≤–∞–∂–Ω–æ—Å—Ç–∏ —Å—Ç–∞—Ç–µ–π —á–µ—Ä–µ–∑ **TF-IDF**;
- –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π **keyword-scoring** (OpenAI, GPT, Python, Spark, Kafka –∏ –¥—Ä.);
- fallback-–ª–æ–≥–∏–∫–∞, –µ—Å–ª–∏ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.

### üì§ –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Telegram
- –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ø–æ—Å—Ç–æ–≤: üí° –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ / üìå –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ / üîó –ò—Å—Ç–æ—á–Ω–∏–∫ / üòÖ –Æ–º–æ—Ä;
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ Telegram (4096 —Å–∏–º–≤–æ–ª–æ–≤);
- –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏, –ø–æ–¥–±–æ—Ä–∫–∏ —Ç—É–ª–∑–æ–≤ –∏ –Ω–µ–¥–µ–ª—å–Ω—ã–µ –¥–∞–π–¥–∂–µ—Å—Ç—ã;
- –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª/—á–∞—Ç –¥–ª—è error-–∞–ª–µ—Ä—Ç–æ–≤.

### üõ° –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è
- retry + backoff –¥–ª—è HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤;
- –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–≤–µ–∂–µ—Å—Ç–∏ –Ω–æ–≤–æ—Å—Ç–µ–π;
- healthcheck –¥–ª—è Docker;
- —Ñ–∞–π–ª–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–æ—Ç–∞—Ü–∏–µ–π.

### ‚úÇÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

–î–ª—è Telegram –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è **–º—è–≥–∫–æ–π –æ–±—Ä–µ–∑–∫–∏ —Ç–µ–∫—Å—Ç–∞**:

- –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è ‚Äî `truncate_message`;
- –æ–±—Ä–µ–∑–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ —Å–ª–æ–≤–∞–º –∏–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞–º —Å—Ç—Ä–æ–∫;
- –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –º–∞—Ä–∫–µ—Ä `(—Å–æ–∫—Ä–∞—â–µ–Ω–æ)`;
- —Å–æ–æ–±—â–µ–Ω–∏—è **–Ω–µ —á–∞–Ω–∫—É—é—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**.
```

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
python -m venv venv
source venv/bin/activate # Windows: venv\Scripts\activate
pip install -r requirements.txt
pytest
```

üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- Pytest

- 100% coverage –ø–æ –≤—Å–µ–º –º–æ–¥—É–ª—è–º

- –û—Å–æ–∑–Ω–∞–Ω–Ω–æ –∏—Å–∫–ª—é—á–µ–Ω—ã —Ç–æ–ª—å–∫–æ thin‚Äëwrapper'—ã –±–µ–∑ –ª–æ–≥–∏–∫–∏
 

üìå –ö–æ–Ω—Ç—Ä–∞–∫—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

-  –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç > 4096 —Å–∏–º–≤–æ–ª–æ–≤:

- –æ–Ω –º—è–≥–∫–æ –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è –≤ truncate_message

- —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å (–ø–æ —Å–ª–æ–≤–∞–º / –ø–µ—Ä–µ–Ω–æ—Å–∞–º —Å—Ç—Ä–æ–∫)

- –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –º–∞—Ä–∫–µ—Ä (—Å–æ–∫—Ä–∞—â–µ–Ω–æ)

–≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ: Telegram‚Äë–∫–∞–Ω–∞–ª ‚Äî –Ω–æ–≤–æ—Å—Ç–Ω–æ–π —Ñ–æ—Ä–º–∞—Ç, –∞ –Ω–µ –ª–æ–≥‚Äë—Å—Ç—Ä–∏–º.

üê≥ Docker (Dev)

```
docker compose up --build

docker build -t news-bot .

docker run --env-file .env news-bot
```

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç .env –∏ –ª–æ–∫–∞–ª—å–Ω—É—é news.db.


ü©∫ Healthcheck

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π self-check:
- ``` test: ["CMD", "python", "-m", "app.healthcheck"] ```

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:

- –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å .env
- –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ë–î
- –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏
- –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- 
```–°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å: healthy.```

üß± Docker (Production)

```mkdir -p data logs```
```touch data/news.db```

–°–æ–∑–¥–∞—Ç—å .env.prod:
```TELEGRAM_BOT_TOKEN=...
TELEGRAM_CHAT_ID=...
TELEGRAM_ERROR_CHAT_ID=...
DATABASE_PATH=/app/news.db
```
–ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

```docker compose -f docker-compose.production.yml up -d --build```

–ü—Ä–æ–≤–µ—Ä–∫–∞:

```docker ps```

```docker logs news-bot --tail 50```

–û–∂–∏–¥–∞–µ–º—ã–π –ª–æ–≥:

–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—â–µ–Ω. –û–∂–∏–¥–∞—é –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤ 09:00 (Europe/Moscow).

–õ–æ–≥–∏

–ù–∞ —Ö–æ—Å—Ç–µ:

```logs/app.log``` 

```logs/error.log```

üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∑–∞–ø—É—Å–∫–∞ (–∫—Ä–∞—Ç–∫–æ)

1. Scheduler –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ 09:00.
2. –í—ã–±–∏—Ä–∞–µ—Ç –Ω–∞–±–æ—Ä —Å–∞–π—Ç–æ–≤ –ø–æ –¥–Ω—é –Ω–µ–¥–µ–ª–∏.

3. –°–æ–±–∏—Ä–∞–µ—Ç —Å—Å—ã–ª–∫–∏.

4. –ü–∞—Ä—Å–∏—Ç HTML ‚Üí —Ç–µ–∫—Å—Ç.

5. –ì–æ—Ç–æ–≤–∏—Ç title + summary.

6. –°—á–∏—Ç–∞–µ—Ç—Å—è TF-IDF score.

7. –°—Ç–∞—Ç—å–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ SQLite.

8. –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è —Ç–æ–ø-5.

9. –í —Å—É–±–±–æ—Ç—É ‚Äî –ø–æ–¥–±–æ—Ä–∫–∞ —Ç—É–ª–∑–æ–≤.

10. –í –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ ‚Äî –¥–∞–π–¥–∂–µ—Å—Ç –Ω–µ–¥–µ–ª–∏.

üó∫ –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞

- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–æ–≤–æ—Å—Ç–µ–π, –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –æ—à–∏–±–∫–∏).
- Retry + –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤.
- –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è (–ø–æ –¥–∞—Ç–µ, –¥–ª–∏–Ω–µ —Ç–µ–∫—Å—Ç–∞, —è–∑—ã–∫—É).
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ RSS/JSON API.
- LLM-–º–æ–¥—É–ª–∏ –¥–ª—è summary/—Ç–µ–≥–æ–≤.
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ—Å—Ç–µ–π.

üìù –õ–∏—Ü–µ–Ω–∑–∏—è
MIT ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π —Å–≤–æ–±–æ–¥–Ω–æ.

‚≠ê –ü–æ–¥–¥–µ—Ä–∂–∏ –ø—Ä–æ–µ–∫—Ç

–ï—Å–ª–∏ –±–æ—Ç –æ–∫–∞–∑–∞–ª—Å—è –ø–æ–ª–µ–∑–Ω—ã–º ‚Äî –ø–æ—Å—Ç–∞–≤—å ‚≠ê –Ω–∞ GitHub. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç—É —Ä–∞—Å—Ç–∏ üôå
```
---

## `PRODUCTION_DEPLOY.md`

```markdown
# üõ† PRODUCTION_DEPLOY.md ‚Äî –∑–∞–ø—É—Å–∫ News Bot –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ News Bot –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ (VPS / Dedicated / Railway / Render) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker –∏ Docker Compose.

---

## 1. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Linux-—Å–µ—Ä–≤–µ—Ä (Ubuntu 20.04+ –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π)
- Docker 24+
- Docker Compose v2+
- –ü—Ä–∞–≤–∞ `sudo`
- Telegram Bot Token
- ID —á–∞—Ç–∞/–∫–∞–Ω–∞–ª–∞ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π
- ID —á–∞—Ç–∞/–∫–∞–Ω–∞–ª–∞ –¥–ª—è –æ—à–∏–±–æ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∏ Docker Compose

–ü—Ä–∏–º–µ—Ä –¥–ª—è Ubuntu:

```bash
sudo apt update
sudo apt install -y ca-certificates curl gnupg lsb-release

curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker.gpg

echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker.gpg] \
  https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" \
  | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
flowchart LR
  S[APScheduler] --> P[NewsProfessor]
  P --> F["Fetch & Parse"]
  F --> R["Rank (TF-IDF / keywords)"]
  R --> D[(SQLite)]
  D --> T["Telegram Post"]
  D --> M[Monitoring]
  M --> A["Alert to Telegram"]
```

üß† –ê–≤—Ç–æ—Ä

–ü—Ä–æ–µ–∫—Ç —Å–¥–µ–ª–∞–Ω –∫–∞–∫ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ:

- –∞–∫—Ü–µ–Ω—Ç –Ω–∞ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞

- —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å

- production‚Äë–º—ã—à–ª–µ–Ω–∏–µ

- –ï—Å–ª–∏ —Ç—ã —Å–º–æ—Ç—Ä–∏—à—å —ç—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫–∞–∫ —Ä–µ–≤—å—é–µ—Ä ‚Äî –¥–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å üôÇ